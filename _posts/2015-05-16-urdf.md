---
layout: post
title: 深入ROS----URDF
category: ROS
comments: true
---

## URDF基础

URDF 是Unified Robot Description Format的缩写，统一机器人描述格式。用于抽象描述机器人硬件和他们的连接，语法是基于XML格式。

### 先验知识

请先通读一下官网上的Tutorials， 网址：[http://wiki.ros.org/urdf/Tutorials](http://wiki.ros.org/urdf/Tutorials)

**任何新的东西，都应该先从官方文档开始。从网上搜索到文章和博客都是第三手资料，只能作为参考，因为文章里包含作者自己的理解，有可能会误导我们。**


### 一些关键概念

* 在URDF语言中，机器人都会由各个连接件(Link)通过关节(Joint)连接而成。URDF主要是描述连接件和关节之间的关系。

* 坐标系（frame）是URDF中最关键的内容，也是ROS中很重要的内容，必须首先把这个彻底搞清楚。Link是通过Joint连接起来的，通常**每一个joint都有一个对应的坐标系**。joint的子连接件(child link)的坐标位置计算完全基于joint这个坐标系。

* 所有连接件都从base_link出发构成一棵树状，所有坐标系也构成一个树状，每一个分支都是如下形式： (frame0) -> base_link -> joint1(frame1) -> link1 -> joint2(frame2)->……， 每个joint都有一个坐标系，后面的link就放置在该坐标系内。如果某个joint 没有设置origin，那么坐标系和前面joint的坐标系一致。
 
* 在joint中origin标签的含义，表示该joint的坐标系是如何基于其父坐标系变换而来。joint的父坐标系就是其上一个joint的坐标系，也是其父连接件（parent link)所在的坐标系。xyz表示在父坐标系中的移动，rpy表示绕父坐标系xyz的转动角度，变换后得到一个新的坐标系。
 
* **link所在的坐标系是它接近根部那端joint的坐标系**，link中origin标签的含义，表示该link是如何放置在坐标系中的。每一个Link都有一个原始的坐标系，原点通常位于<geometry>元素定义的几何中心，例如box的中心或者cylinder的中心。没有设置origin时，该原始坐标系直接和它所在的joint坐标系重合，也就是说把中心点放在joint坐标系中心，xyz方向和坐标系方向完全一致。

* base_link的坐标系怎么确定呢？后面小车的例子中直接用box的原始坐标系，也就是几何中心点为原点。如果是一个6轴机械臂，通常以安装法兰位置的中心为原点设置第一个坐标系。

* 坐标系的定义时，通常遵循以下约定：转动关节绕着Z轴转动，按照右手原则，逆时针转为正角度，顺时针为负角度。小车在平面上运动时以向前为x轴，向左为y轴，向上为Z轴（也符合前面一条小车绕着Z轴转动）。

## 创建小车模型并在Rviz中观察

### 小车描述

小车由5部分组成，车身，4个轮子。车身为长方体（box），轮子为4个圆柱体（cylinder ）。各部分尺寸如下：
车身：    30cm（长） x 20cm（宽） x 10cm（高）  
轮子：    半径 6cm   厚度 2cm
完整图


### 车身和左前轮

```xml
	<a>
	</a>
```

* axis 表示转动轴方向，它是一个矢量，满足 x * x + y * y + z * z = 1 

### 在Rviz中观察



`newFixedThreadPool` 可以创建固定数目的线程，一旦创建不会自动销毁线程，即便长期没有任务。除非显式关闭线程池。如果任务队列中有任务，就取出任务执行。




